from gensim.models import KeyedVectors
from sklearn.cluster import KMeans
import pprint

model = KeyedVectors.load_word2vec_format('GoogleNews-vectors-negative300.bin.gz', binary=True)

with open("text.txt", mode="r")as f:
    countries = f.read().replace(" ", "_").splitlines()  # 国名リスト　スペースを"_"にし，改行を削除するためにreadからsplitlisens
countries = [country for country in countries if country in model]  # modelに含まれる国名のみ抽出
countries_vec = [model[country] for country in countries]  # 国名のベクトルリスト
answer = KMeans(n_clusters=5).fit_predict(countries_vec)   # クラスタリング
pprint.pprint(dict(zip(countries, answer)))

'''
% python nlp100_67.py
{'Afghanistan': 0,
 'Albania': 0,
 'Algeria': 2,
 'Andorra': 3,
 'Angola': 2,
 'Argentina': 4,
 'Armenia': 0,
 'Austria': 3,
 'Azerbaijan': 0,
 'Bahrain': 1,
 'Bangladesh': 1,
 'Barbados': 4,
 'Belarus': 0,
 'Belgium': 3,
 'Belize': 4,
 'Benin': 2,
 'Bhutan': 1,
 'Bolivia': 4,
 'Botswana': 2,
 'Brazil': 4,
 'Brunei': 1,
 'Bulgaria': 0,
 'Burkina_Faso': 2,
 'Burundi': 2,
 'Cabo_Verde': 4,
 'Cambodia': 1,
 'Cameroon': 2,
 'Canada': 1,
 'Chad': 2,
 'Channel_Islands': 3,
 'Chile': 4,
 'China': 1,
 'Colombia': 4,
 'Comoros': 2,
 'Congo': 2,
 'Costa_Rica': 4,
 'Croatia': 3,
 'Cuba': 4,
 'Cyprus': 0,
 'Czech_Republic': 3,
 'DR_Congo': 2,
 'Denmark': 3,
 'Djibouti': 2,
 'Dominica': 4,
 'Dominican_Republic': 4,
 'Ecuador': 4,
 'Egypt': 0,
 'El_Salvador': 4,
 'Equatorial_Guinea': 2,
 'Eritrea': 2,
 'Estonia': 3,
 'Ethiopia': 2,
 'Faeroe_Islands': 3,
 'Finland': 3,
 'France': 3,
 'French_Guiana': 4,
 'Gabon': 2,
 'Gambia': 2,
 'Georgia': 0,
 'Germany': 3,
 'Ghana': 2,
 'Gibraltar': 3,
 'Greece': 3,
 'Grenada': 4,
 'Guatemala': 4,
 'Guinea': 2,
 'Guyana': 4,
 'Haiti': 4,
 'Holy_See': 0,
 'Honduras': 4,
 'Hong_Kong': 1,
 'Hungary': 3,
 'Iceland': 3,
 'India': 1,
 'Indonesia': 1,
 'Iran': 0,
 'Iraq': 0,
 'Ireland': 3,
 'Israel': 0,
 'Italy': 3,
 'Jamaica': 4,
 'Japan': 1,
 'Jordan': 1,
 'Kazakhstan': 0,
 'Kenya': 2,
 'Kuwait': 1,
 'Kyrgyzstan': 0,
 'Laos': 1,
 'Latvia': 3,
 'Lebanon': 0,
 'Lesotho': 2,
 'Liberia': 2,
 'Libya': 0,
 'Liechtenstein': 3,
 'Lithuania': 3,
 'Luxembourg': 3,
 'Macao': 1,
 'Madagascar': 2,
 'Malawi': 2,
 'Malaysia': 1,
 'Maldives': 1,
 'Mali': 2,
 'Malta': 3,
 'Mauritania': 2,
 'Mauritius': 1,
 'Mayotte': 2,
 'Mexico': 4,
 'Moldova': 0,
 'Monaco': 3,
 'Mongolia': 1,
 'Montenegro': 3,
 'Morocco': 1,
 'Mozambique': 2,
 'Myanmar': 1,
 'Namibia': 2,
 'Nepal': 1,
 'Netherlands': 3,
 'Nicaragua': 4,
 'Niger': 2,
 'Nigeria': 2,
 'North_Korea': 0,
 'Norway': 3,
 'Oman': 1,
 'Pakistan': 1,
 'Panama': 4,
 'Paraguay': 4,
 'Peru': 4,
 'Philippines': 1,
 'Poland': 3,
 'Portugal': 3,
 'Qatar': 1,
 'Romania': 3,
 'Russia': 0,
 'Rwanda': 2,
 'Réunion': 2,
 'Saint_Lucia': 4,
 'San_Marino': 3,
 'Saudi_Arabia': 1,
 'Senegal': 2,
 'Serbia': 0,
 'Seychelles': 2,
 'Sierra_Leone': 2,
 'Singapore': 1,
 'Slovakia': 3,
 'Slovenia': 3,
 'Somalia': 2,
 'South_Africa': 2,
 'South_Korea': 1,
 'Spain': 3,
 'Sri_Lanka': 1,
 'Sudan': 2,
 'Suriname': 4,
 'Sweden': 3,
 'Switzerland': 3,
 'Syria': 0,
 'Taiwan': 1,
 'Tajikistan': 0,
 'Tanzania': 2,
 'Thailand': 1,
 'Togo': 2,
 'Tunisia': 2,
 'Turkey': 0,
 'Turkmenistan': 0,
 'Uganda': 2,
 'Ukraine': 0,
 'United_Arab_Emirates': 1,
 'United_Kingdom': 1,
 'United_States': 1,
 'Uruguay': 4,
 'Uzbekistan': 0,
 'Venezuela': 4,
 'Vietnam': 1,
 'Western_Sahara': 0,
 'Yemen': 0,
 'Zambia': 2,
 'Zimbabwe': 2}
'''
